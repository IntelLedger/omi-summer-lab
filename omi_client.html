

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>OMI Client JavaScript SDK &mdash; OMI Summer Lab latest documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="OMI Summer Lab latest documentation" href="index.html"/>
        <link rel="next" title="OMI Summer Lab Transaction Family Specification" href="transaction_family_specification.html"/>
        <link rel="prev" title="Modifying the OMI Transaction Processor" href="txn_processor_dev.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="contents.html" class="icon icon-home"> OMI Summer Lab
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="welcome.html">Welcome to OMI Summer Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="txn_processor_dev.html">Modifying the OMI Transaction Processor</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">OMI Client JavaScript SDK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#webpack-configuration">Webpack configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setting-objects">Setting Objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#checking-commit-status">Checking Commit Status</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reading-objects">Reading Objects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#development">Development</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transaction_family_specification.html">OMI Summer Lab Transaction Family Specification</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="contents.html">OMI Summer Lab</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="contents.html">Docs</a> &raquo;</li>
        
      <li>OMI Client JavaScript SDK</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/omi_client.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="omi-client-javascript-sdk">
<h1>OMI Client JavaScript SDK<a class="headerlink" href="#omi-client-javascript-sdk" title="Permalink to this headline">¶</a></h1>
<p>The OMI Summer Lab JavaScript SDK provides a simple client to submit and fetch
values to a Hyperledger Sawtooth blockchain.</p>
<p>See the <a class="reference external" href="omi_client/index.html">OMI JavaScript SDK JSDoc</a>.</p>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>Requires Node 6.x or greater.</strong></p>
</div>
<p>In your project, install the <cite>omi-client</cite> using the github repository location:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> npm install IntelLedger/omi-summer-lab
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note, some of the underlying packages are built with
<a class="reference external" href="https://github.com/mafintosh/prebuild">prebuild</a>.  Installs will be much
faster if you install
<a class="reference external" href="https://github.com/mafintosh/prebuild-install">prebuild-install</a>.</p>
</div>
<p>You will also need to install the underlying sawtooth-sdk dependency, which
will have been included as part of the omi-summer-lab installation. Run the
following step:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> npm install ./node_modules/omi-client/omi-client/dependencies/sawtooth-core/sdk/javascript
</pre></div>
</div>
<p>This can be added to your <cite>package.json</cite> as a <cite>postinstall</cite> step, for future
installations.</p>
<div class="section" id="webpack-configuration">
<h3>Webpack configuration<a class="headerlink" href="#webpack-configuration" title="Permalink to this headline">¶</a></h3>
<p>If you are using a tool like Webpack, you will need to include an alias for the
zeromq library, which cannot be included in the browser. A mock module has been
included with the <cite>omi-client</cite> installation, and can be referenced in your
webpack configuration file (see <cite>examples/webclient/webpack.config.js</cite>).</p>
<p>A <cite>webpack.config.js</cite> should include the following:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// ...</span>
<span class="nx">resolve</span><span class="o">:</span> <span class="p">{</span>
  <span class="nx">alias</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">zeromq$</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;./node_modules/omi-client/omi-client/lib/mock_zeromq.js&#39;</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// ...</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>To submit items to the block chain, or read existing items value off the global
state, you must create an <cite>OmiClient</cite>.  It can be created with a private key you
can generate, or one that has been saved to disk.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">let</span> <span class="p">{</span><span class="nx">OmiClient</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;omi-client&#39;</span><span class="p">)</span>
<span class="kd">let</span> <span class="p">{</span><span class="nx">signer</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;sawtooth-sdk&#39;</span><span class="p">)</span>

<span class="kr">const</span> <span class="nx">sawtoothBaseUrl</span> <span class="o">=</span> <span class="s1">&#39;http://localhost:8080&#39;</span>
<span class="kr">const</span> <span class="nx">privateKey</span> <span class="o">=</span> <span class="nx">signer</span><span class="p">.</span><span class="nx">makePrivateKey</span><span class="p">()</span> <span class="c1">// or load existing key from some other source</span>

<span class="kd">let</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OmiClient</span><span class="p">(</span><span class="nx">sawtoothBaseUrl</span><span class="p">,</span> <span class="nx">privateKey</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="setting-objects">
<h3>Setting Objects<a class="headerlink" href="#setting-objects" title="Permalink to this headline">¶</a></h3>
<p>Objects are set in the global state via a transaction submitted to the block
chain. These objects are <cite>IndividualIdentity</cite>, <cite>OrganizationalIdentity</cite>,
<cite>Recording</cite>, and <cite>Work</cite>. Each has a corresponding <cite>set</cite> method on the
<cite>OmiClient</cite>: <cite>setIndividual</cite> for <cite>IndividualIdentity</cite>, and so on.</p>
<p>Initial sets of an object result in a new object being stored in the global
state.  Subsequent sets of an object result in an update operation.  These
updates may only be performed by the owner of the private key that signed the
original set operation.  In other words, ownership of the object is controlled
by the public key associated with the private key used to create it.</p>
<p><cite>OrganizationalIdentity</cite> and <cite>Recordings</cite> both have type enumerations.  These
can be accessed via</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">let</span> <span class="p">{</span><span class="nx">OrganizationalIdentity</span><span class="p">,</span> <span class="nx">Recording</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;omi-client/protobuf&#39;</span><span class="p">)</span>

<span class="c1">// and used like so (with an Organization example):</span>

<span class="nx">client</span><span class="p">.</span><span class="nx">setOrganization</span><span class="p">({</span>
  <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Sawtooth Music Group&#39;</span><span class="p">,</span>
  <span class="nx">type</span><span class="o">:</span> <span class="nx">OrganizationalIdentity</span><span class="p">.</span><span class="nx">Type</span><span class="p">.</span><span class="nx">LABEL</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">((</span><span class="nx">statusChecker</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">})</span>
</pre></div>
</div>
<div class="section" id="checking-commit-status">
<h4>Checking Commit Status<a class="headerlink" href="#checking-commit-status" title="Permalink to this headline">¶</a></h4>
<p>As seen in the above example, any <cite>set</cite> method returns a JavaScript Promise for
the current status of the transaction submission.  A call to its <cite>check</cite> method
will request the status, returning either <cite>“COMMITTED”</cite> or <cite>“PENDING”</cite>, in the
case of a time out.</p>
<p>For example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">client</span><span class="p">.</span><span class="nx">setIndividual</span><span class="p">({</span> <span class="cm">/* some fields */</span> <span class="p">})</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">statusChecker</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">status</span><span class="p">.</span><span class="nx">check</span><span class="p">())</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">status</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">status</span> <span class="o">==</span> <span class="s1">&#39;COMMITTED&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// update a UI or log a message</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="c1">// Pending - check again, or consider the transaction a failure</span>
        <span class="p">}</span>
      <span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reading-objects">
<h3>Reading Objects<a class="headerlink" href="#reading-objects" title="Permalink to this headline">¶</a></h3>
<p>Objects in the global state each have a pair of methods for reading values: a
get-by-id method and a get-list method.  Like set, there is one for each OMI
Object: <cite>getIndividual</cite> for a single <cite>IndividualIdentity</cite>, and <cite>getIndividuals</cite>
for a cursor into a list of <cite>IndividualIdentity</cite>.  <cite>OrganizationalIdentity</cite>,
<cite>Recording</cite>, and <cite>Work</cite> follow suit.</p>
<p>To get all individuals, for example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">client</span><span class="p">.</span><span class="nx">getIndividuals</span><span class="p">().</span><span class="nx">all</span><span class="p">().</span><span class="nx">then</span><span class="p">((</span><span class="nx">individuals</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
   <span class="c1">// print or update a UI of individuals</span>
<span class="p">})</span>
</pre></div>
</div>
<p>To iterator over the individuals, for example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">client</span><span class="p">.</span><span class="nx">getIndividuals</span><span class="p">().</span><span class="nx">each</span><span class="p">((</span><span class="nx">err</span><span class="p">,</span> <span class="nx">individual</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Error occurred reading an individual&#39;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="c1">// print or update a UI individual. E.g.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Individual </span><span class="si">${</span><span class="nx">individual</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
<p>An specific individual can be fetched by its natural key, in this case name:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">client</span><span class="p">.</span><span class="nx">getIndividual</span><span class="p">(</span><span class="s1">&#39;David Bowie&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">individual</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">individual</span><span class="p">.</span><span class="nx">ISNI</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="development">
<h2>Development<a class="headerlink" href="#development" title="Permalink to this headline">¶</a></h2>
<p>Checkout the repo and cd to <cite>&lt;omi-summer-lab&gt;/</cite> and type:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> npm install
<span class="gp">$</span> npm run compile-protobuf
</pre></div>
</div>
<p>To run the unit tests:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> npm <span class="nb">test</span>
</pre></div>
</div>
<p>To build the docs:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> npm run build-docs
</pre></div>
</div>
<p>The generated docs can be found in <cite>&lt;omi-summer-lab&gt;/omi-client/docs</cite>.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="transaction_family_specification.html" class="btn btn-neutral float-right" title="OMI Summer Lab Transaction Family Specification" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="txn_processor_dev.html" class="btn btn-neutral" title="Modifying the OMI Transaction Processor" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Intel Corporation.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'latest',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
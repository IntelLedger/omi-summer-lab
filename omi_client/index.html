<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3> </h3>










    




    <section>
        <article><h1>OMI Summer Lab JavaScript SDK</h1><p>The OMI Summer Lab JavaScript SDK provides a simple client to submit and fetch
values to a Hyperledger Sawtooth blockchain.</p>
<h2>Getting Started</h2><p><strong>Requires Node 6.x or greater.</strong></p>
<p>In your project, install the <code>omi-client</code> using the github repository location:</p>
<pre class="prettyprint source"><code>$ npm install IntelLedger/omi-summer-lab</code></pre><blockquote>
<p>Note, some of the underlying packages are built with
<a href="https://github.com/mafintosh/prebuild">prebuild</a>.  Installs will be much
faster if you install
<a href="https://github.com/mafintosh/prebuild-install">prebuild-install</a>.</p>
</blockquote>
<p>You will also need to install the underlying sawtooth-sdk dependency, which
will have been included as part of the omi-summer-lab installation. Run the
following step:</p>
<pre class="prettyprint source"><code>$ npm install
./node_modules/omi-client/omi-client/dependencies/sawtooth-core/sdk/javascript</code></pre><p>This can be added to your <code>package.json</code> as a <code>postinstall</code> step, for future
installations.</p>
<h3>Webpack configuration</h3><p>If you are using a tool like Webpack, you will need to include an alias for the
zeromq library, which cannot be included in the browser. A mock module has been
included with the <code>omi-client</code> installation, and can be referenced in your
webpack configuration file (see <code>examples/webclient/webpack.config.js</code>).</p>
<p>A <code>webpack.config.js</code> should include the following:</p>
<pre class="prettyprint source"><code>  // ...
  resolve: {
    alias: {
      zeromq$: path.resolve(__dirname, './node_modules/omi-client/omi-client/lib/mock_zeromq.js')
    }
  }
  // ...</code></pre><h2>Usage</h2><p>To submit items to the block chain, or read existing items value off the global
state, you must create an <code>OmiClient</code>.  It can be created with a private key you
can generate, or one that has been saved to disk.</p>
<pre class="prettyprint source"><code>let {OmiClient} = require('omi-client')
let {signer} = require('sawtooth-sdk')

const sawtoothBaseUrl = 'http://localhost:8080'
const privateKey = signer.makePrivateKey() // or load existing key from some other source

let client = new OmiClient(sawtoothBaseUrl, privateKey)</code></pre><h3>Setting Objects</h3><p>Objects are set in the global state via a transaction submitted to the block
chain. These objects are <code>IndividualIdentity</code>, <code>OrganizationalIdentity</code>,
<code>Recording</code>, and <code>Work</code>. Each has a corresponding <code>set</code> method on the
<code>OmiClient</code>: <code>setIndividual</code> for <code>IndividualIdentity</code>, and so on.</p>
<p>Initial sets of an object result in a new object being stored in the global
state.  Subsequent sets of an object result in an update operation.  These
updates may only be performed by the owner of the private key that signed the
original set operation.  In other words, ownership of the object is controlled
by the public key associated with the private key used to create it.</p>
<p><code>OrganizationalIdentity</code> and <code>Recordings</code> both have type enumerations.  These
can be accessed via</p>
<pre class="prettyprint source"><code>let {OrganizationalIdentity, Recording} = require('omi-client/protobuf')

// and used like so (with an Organization example):

client.setOrganization({
  name: 'Sawtooth Music Group',
  type: OrganizationalIdentity.Type.LABEL
}).then((statusChecker) => {
  // ...
})</code></pre><h4>Checking Commit Status</h4><p>As seen in the above example, any <code>set</code> method returns a JavaScript Promise for
the current status of the transaction submission.  A call to its <code>check</code> method
will request the status, returning either <code>&quot;COMMITTED&quot;</code> or <code>&quot;PENDING&quot;</code>, in the
case of a time out.</p>
<p>For example:</p>
<pre class="prettyprint source"><code>client.setIndividual({ /* some fields */ })
      .then((statusChecker) => status.check())
      .then((status) => {
        if (status == 'COMMITTED') {
          // update a UI or log a message
        } else {
          // Pending - check again, or consider the transaction a failure
        }
      })</code></pre><h3>Reading Objects</h3><p>Objects in the global state each have a pair of methods for reading values: a
get-by-id method and a get-list method.  Like set, there is one for each OMI
Object: <code>getIndividual</code> for a single <code>IndividualIdentity</code>, and <code>getIndividuals</code>
for a cursor into a list of <code>IndividualIdentity</code>.  <code>OrganizationalIdentity</code>,
<code>Recording</code>, and <code>Work</code> follow suit.</p>
<p>To get all individuals, for example:</p>
<pre class="prettyprint source"><code>client.getIndividuals().all().then((individuals) => {
   // print or update a UI of individuals
})</code></pre><p>To iterator over the individuals, for example:</p>
<pre class="prettyprint source"><code>client.getIndividuals().each((err, individual) => {
  if (err) {
     console.log('Error occurred reading an individual', err)
  }

  // print or update a UI individual. E.g.
  console.log(`Individual ${individual.name}`)
})</code></pre><p>An specific individual can be fetched by its natural key, in this case name:</p>
<pre class="prettyprint source"><code>client.getIndividual('David Bowie').then((individual) => {
   console.log(individual.ISNI)
})</code></pre><h2>Development</h2><p>Checkout the repo and cd to <code>&lt;omi-summer-lab&gt;/</code> and type:</p>
<pre class="prettyprint source"><code>$ npm install
$ npm run compile-protobuf</code></pre><p>To run the unit tests:</p>
<pre class="prettyprint source"><code>$ npm test</code></pre><p>To build the docs:</p>
<pre class="prettyprint source"><code>$ npm run build-docs</code></pre><p>The generated docs can be found in <code>&lt;omi-summer-lab&gt;/omi-client/docs</code>.</p>
<h2>License</h2><p><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a></p>
<p>Copyright 2017 Intel Corporation</p></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-omi-client.html">omi-client</a></li><li><a href="module-omi-client_addressing.html">omi-client/addressing</a></li><li><a href="module-omi-client_protobuf.html">omi-client/protobuf</a></li></ul><h3>Externals</h3><ul><li><a href="external-Message.html">Message</a></li></ul><h3>Classes</h3><ul><li><a href="module-omi-client_protobuf.IndividualIdentity.html">IndividualIdentity</a></li><li><a href="module-omi-client_protobuf.OMITransactionPayload.html">OMITransactionPayload</a></li><li><a href="module-omi-client_protobuf.OrganizationalIdentity.html">OrganizationalIdentity</a></li><li><a href="module-omi-client_protobuf.Recording.html">Recording</a></li><li><a href="module-omi-client_protobuf.Work.html">Work</a></li><li><a href="module-omi-client-Cursor.html">Cursor</a></li><li><a href="module-omi-client-OmiClient.html">OmiClient</a></li><li><a href="module-omi-client-StatusChecker.html">StatusChecker</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Wed Jun 07 2017 09:31:54 GMT-0500 (CDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>